# yaml-language-server: $schema=../../tools/ai-codegen/codegen.schema.json
spec: https://app.stainless.com/api/spec/documented/openai/openapi.documented.yml
output: src/Generated.ts
name: OpenAiClient
patches:
  - '[{"op":"replace","path":"/openapi","value":"3.0.0"}]'
  - '[{"op":"add","path":"/components/schemas/ModelResponseProperties/properties/user/nullable","value":true}]'
  - '[{"op":"add","path":"/components/schemas/ModelResponseProperties/properties/safety_identifier/nullable","value":true}]'
  - '[{"op":"add","path":"/components/schemas/ModelResponseProperties/properties/prompt_cache_key/nullable","value":true}]'
  - '[{"op":"add","path":"/components/schemas/Response/allOf/2/properties/usage/nullable","value":true}]'
  - '[{"op":"remove","path":"/components/schemas/ResponseFunctionCallArgumentsDoneEvent/required/2"}]'
  - '[{"op":"remove","path":"/components/schemas/WebSearchActionSearch/required/1"}]'
replacements:
  # Schema.Unknown doesn't work with Schema.toCodecJson (used by HttpClientResponse.schemaBodyJson)
  # Replace with Schema.Json which properly handles arbitrary JSON values
  - from: "Schema.Record(Schema.String, Schema.Unknown)"
    to: "Schema.Record(Schema.String, Schema.Json)"
  - from: "{ readonly [x: string]: unknown }"
    to: "{ readonly [x: string]: Schema.Json }"
  # Index signature in struct rest pattern
  - from: "readonly [x: string]: unknown"
    to: "readonly [x: string]: Schema.Json"
